(()=>{"use strict";const t=[{author:"Иван Айвазовский",name:"Девятый вал",year:"1850"},{author:"Илья Репин",name:"Бурлаки на Волге",year:"1873"},{author:"Илья Репин",name:"Не ждали",year:"1888"},{author:"Илья Репин",name:"Вечорници",year:"1881"},{author:"Илья Репин",name:"Проводы новобранца",year:"1879"},{author:"Илья Репин",name:"Крестный ход",year:"1883"},{author:"Илья Репин",name:"Иван Грозный и сын его Иван",year:"1885"},{author:"Илья Репин",name:"Садко",year:"1876"},{author:"Илья Репин",name:"Приготовление к экзамену",year:"1864"},{author:"Илья Репин",name:"Летний пейзаж",year:"1879"},{author:"Илья Репин",name:"Запорожцы",year:"1891"},{author:"Иван Крамской",name:"Неизвестная",year:"1883"},{author:"Сандро Боттичелли",name:"Рождение Венеры",year:"1486"},{author:"Иван Шишкин",name:"Утро в сосновом лесу",year:"1889"},{author:"Рембрандт",name:"Ночной дозор",year:"1642"},{author:"Леонардо да Винчи",name:"Тайная вечеря",year:"1498"},{author:"Сальвадор Дали",name:"Постоянство памяти",year:"1931"},{author:"Поль Гоген",name:"Откуда мы пришли? Кто мы? Куда мы идём?",year:"1898"},{author:"Эжен Делакруа",name:"Свобода, ведущая народ",year:"1830"},{author:"Михаил Врубель",name:"Демон сидящий",year:"1890"},{author:"Эдуар Мане",name:"Бар в «Фоли-Бержер»",year:"1882"},{author:"Тициан",name:"Любовь земная и Любовь небесная",year:"1516"},{author:"Михаил Нестеров",name:"Видение отроку Варфоломею",year:"1890"},{author:"Питер Брейгель",name:"Притча о слепых",year:"1568"},{author:"Виктор Васнецов",name:"Аленушка",year:"1881"},{author:"Карл Брюллов",name:"Последний день Помпеи",year:"1833"},{author:"Пабло Пикассо",name:"Девочка на шаре",year:"1905"},{author:"Эдгар Дега",name:"Голубые танцовщицы",year:"1897"},{author:"Леонардо да Винчи",name:"Мона Лиза",year:"1505"},{author:"Микеланджело",name:"Сотворение Адама",year:"1511"},{author:"Ян Вермеер",name:"Девушка с жемчужной серёжкой",year:"1665"},{author:"Василий Суриков",name:"Боярыня Морозова",year:"1887"},{author:"Виктор Васнецов",name:"Богатыри",year:"1898"},{author:"Андрей Рублев",name:"Троица",year:"1411"},{author:"Пабло Пикассо",name:"Герника",year:"1937"},{author:"Иероним Босх",name:"Сад земных наслаждений",year:"1510"},{author:"Эдвард Мунк",name:"Крик",year:"1893"},{author:"Марк Шагал",name:"Прогулка",year:"1918"},{author:"Иванов Александр",name:"Явление Христа народу",year:"1857"},{author:"Федотов Павел",name:"Сватовство майора",year:"1852"},{author:"Василий Верещагин",name:"Апофеоз войны",year:"1817"},{author:"Джорджоне",name:"Спящая Венера",year:"1510"},{author:"Питер Брейгель",name:"Охотники на снегу",year:"1565"},{author:"Караваджо",name:"Лютнист",year:"1596"},{author:"Рембрандт",name:"Даная",year:"1647"},{author:"Джованни Беллини",name:"Пир богов",year:"1514"},{author:"Ян ван Эйк",name:"Портрет четы Арнольфини",year:"1434"},{author:"Сандро Боттичелли",name:"Весна",year:"1482"},{author:"Леонардо да Винчи",name:"Благовещение",year:"1475"},{author:"Леонардо да Винчи",name:"Дама с горностаем",year:"1490"},{author:"Леонардо да Винчи",name:"Мадонна Литта",year:"1491"},{author:"Рафаэль",name:"Дама с единорогом",year:"1506"},{author:"Рафаэль",name:"Мадонна Бельведерская",year:"1506"},{author:"Рафаэль",name:"Сикстинская Мадонна",year:"1520"},{author:"Тициан",name:"Динарий Кесаря",year:"1516"},{author:"Тициан",name:"Кающаяся Марина Магдалина",year:"1565"},{author:"Тициан",name:"Вакханалия",year:"1526"},{author:"Тициан",name:"Венера Урбинская",year:"1534"},{author:"Тициан",name:"Конный портрет Карла V",year:"1548"},{author:"Альбрехт Дюрер",name:"Адам и Ева",year:"1507"},{author:"Альбрехт Дюрер",name:"Праздник четок",year:"1506"},{author:"Веронезе",name:"Марс и Венера",year:"1560"},{author:"Веронезе",name:"Пир в доме Левия",year:"1563"},{author:"Эль Греко",name:"Апостолы Петр и Павел",year:"1592"},{author:"Рембрандт",name:"Автопортрет с Саскией",year:"1635"},{author:"Рембрандт",name:"Христос и грешница",year:"1644"},{author:"Веласкес",name:"Бахус",year:"1628"},{author:"Веласкес",name:"Инфанта Маргарита",year:"1654"},{author:"Веласкес",name:"Поклонение волхвов",year:"1619"},{author:"Веласкес",name:"Вилла Медичи в Риме. Полдень",year:"1630"},{author:"Веласкес",name:"Венера с зеркалом",year:"1651"},{author:"Веласкес",name:"Кузница вулкана",year:"1630"},{author:"Веласкес",name:"Менины",year:"1656"},{author:"Веласкес",name:"Сдача Бреды",year:"1635"},{author:"Бартоломео Мурильо",name:"Мадонна с четками",year:"1655"},{author:"Бартоломео Мурильо",name:"Явление и дар Богородицы",year:"1655"},{author:"Бартоломео Мурильо",name:"Мальчик с собакой",year:"1650"},{author:"Бартоломео Мурильо",name:"Непорочное зачатие",year:"1678"},{author:"Никола Пуссен",name:"Пейзаж с Полифемом",year:"1649"},{author:'Ян Вермеер "Служанка с кувшином молока',name:"Молочница",year:"1660"},{author:"Жан Этьен Лиотар",name:"Шоколадница",year:"1745"},{author:"Жан Фрагонар",name:"Качели",year:"1767"},{author:"Жан Фрагонар",name:"Поцелуй украдкой",year:"1788"},{author:"Гейнсборо",name:"Дама в голубом",year:"1780"},{author:"Жан Батист Грёз",name:"Избалованное дитя",year:"1765"},{author:"Жан Батист Грёз",name:"Деревенская помолвка",year:"1761"},{author:"Владимир Боровиковский",name:"Портрет Лопухиной",year:"1797"},{author:"Джон Констебл",name:"Вид на собор в Солсбери из епископского сада",year:"1823"},{author:"Василий Тропинин",name:"Кружевница",year:"1823"},{author:"Алексей Венецианов",name:"На жатве. Лето",year:"1827"},{author:"Алексей Венециановн",name:"Спящий пастушок",year:"1826"},{author:"Алексей Венецианов",name:"На пашне. Весна",year:"1820"},{author:"Карл Брюллов",name:"Итальянский полдень",year:"1827"},{author:"Карл Брюллов",name:"Всадница",year:"1832"},{author:"Василий Перов",name:"Приезд гувернантки в купеческий дом",year:"1866"},{author:"Василий Перов",name:"Тройка",year:"1866"},{author:"Василий Перов",name:"Сельский крестный ход на Пасхе",year:"1861"},{author:"Василий Перов",name:"Птицелов",year:"1870"},{author:"Василий Перов",name:"Охотники на привале",year:"1871"},{author:"Алексей Саврасов",name:"Грачи прилетели",year:"1871"},{author:"Фёдор Васильев",name:"Мокрый луг",year:"1872"},{author:"Константин Маковский",name:"Дети, бегущие от грозы",year:"1872"},{author:"Константин Маковский",name:"Боярский свадебный пир",year:"1883"},{author:"Константин Маковский",name:"Гадание",year:"1890"},{author:"Константин Маковский",name:"Портрет графини Софьи",year:"1890"},{author:"Константин Маковский",name:"Перемещение ковра Мухаммеда из Мекки в Каир",year:"1875"},{author:"Василий Поленов",name:"Деревня Окулова гора",year:"1860"},{author:"Василий Поленов",name:"Переправа через реку",year:"1872"},{author:"Василий Поленов",name:"В парке",year:"1874"},{author:"Василий Поленов",name:"Московский дворик",year:"1877"},{author:"Василий Поленов",name:"Бабушкин сад",year:"1878"},{author:"Огюст Ренуар",name:"Мост в Шату",year:"1875"},{author:"Огюст Ренуар",name:"Прогулка в Булонском лесу",year:"1873"},{author:"Огюст Ренуар",name:"Портрет Жанны Самари",year:"1877"},{author:"Огюст Ренуар",name:"Завтрак гребцов",year:"1881"},{author:"Огюст Ренуар",name:"Зонтики",year:"1886"},{author:"Архип Куинджи",name:"На острове Валааме",year:"1873"},{author:"Архип Куинджи",name:"Украинская ночь",year:"1876"},{author:"Архип Куинджи",name:"Берёзовая роща",year:"1879"},{author:"Архип Куинджи",name:"Лунная ночь на Днепре",year:"1880"},{author:"Василий Суриков",name:"Утро стрелецкой казни",year:"1881"},{author:"Василий Суриков",name:"Взятие снежного городка",year:"1891"},{author:"Василий Суриков",name:"Покорение Сибири Ермаком Тимофеевичем",year:"1895"},{author:"Василий Суриков",name:"Переход Суворова через Альпы",year:"1899"},{author:"Валентин Серов",name:"Девочка с персиками",year:"1887"},{author:"Исаак Левитан",name:"Над вечным покоем",year:"1894"},{author:"Исаак Левитан",name:"Март",year:"1895"},{author:"Исаак Левитан",name:"Золотая осень",year:"1895"},{author:"Иван Шишкин",name:"Ручей в берёзовом лесу",year:"1883"},{author:"Иван Шишкин",name:"Рожь",year:"1878"},{author:"Иван Шишкин",name:"Корабельная роща",year:"1898"},{author:"Александра Маковский",name:"Надоела",year:"1897"},{author:"Франсуа Буше",name:"Четыре сезона - Весна",year:"1755"},{author:"Виктор Васнецов",name:"Витязь на распутье",year:"1878"},{author:"Виктор Васнецов",name:"Ковер-самолёт",year:"1880"},{author:"Виктор Васнецов",name:"Три царевны подземного царства",year:"1884"},{author:"Виктор Васнецов",name:"Иван-царевич на Сером Волке",year:"1888"},{author:"Виктор Васнецов",name:"Царь Иван Васильевич Грозный",year:"1896"},{author:"Николай Богданов-Бельский",name:"Устный счёт",year:"1895"},{author:"Николай Богданов-Бельский",name:"У дверей школы",year:"1897"},{author:"Эдуард Мане",name:"Женщина с кувшином",year:"1858"},{author:"Клод Лоррен",name:"Отплытие святой Урсулы",year:"1614"},{author:"Карл Лемох",name:"Варька",year:"1893"},{author:"Василий тропинин",name:"Девушка с горшком роз",year:"1850"},{author:"Гюстав Курбе",name:"Мастерская художника",year:"1855"},{author:"Иван Богданов",name:"За расчётом",year:"1890"},{author:"Иван Богданов",name:"Новичок",year:"1893"},{author:"Рене Магритт",name:"Сын человеческий",year:"1964"},{author:"Сальвадор Дали",name:"Сон, вызванный полётом пчелы вокруг граната, за секунду до пробуждения",year:"1944"},{author:"Казимир Малевич",name:"Черный квадрат",year:"1915"}],e=new class{constructor(){this.string={en:{resetBtn:"new game",gemPuzzle:"gem-puzzle",startBtn:"start",stopBtn:"pause",saveBtn:"save",loadBtn:"load",bestResBtn:"results",soundBtn:"sound ON",soundBtnOFF:"sound OFF",stepBtn:"auto",step:"step: ",winSlug1:"You win! steps:",winSlug2:"time:",close:"close",load:"load game",bestres:"the best results"},ru:{resetBtn:"заново",gemPuzzle:"пятнашки",stopBtn:"пауза",startBtn:"начать",saveBtn:"сохранить",loadBtn:"загрузить",bestResBtn:"результаты",soundBtn:"звук ВКЛ",soundBtnOFF:"звук ВЫВКЛ",stepBtn:"авто",step:"шаг: ",winSlug1:"Победа! шагов:",winSlug2:"время:",close:"закрыть",load:"загрузить игру",bestres:"лучшие результаты"}},this.lang="ru",this.mainEl=null,this.mainContainer=null,this.innerEl=null,this.el=null,this.tempLog="",this.tempLogBR="\n",this.sattingsBoardContainer=null,this.gameBoardContainer=null,this.dashBoardContainer=null,this.timer=null,this.timerVal=null,this.isPaused=!0,this.stopStartBtn=null,this.timerID=null,this.step=0,this.stepCounterObj=null,this.solvingHint=null,this.winHint=null,this.imagesDescribe=null,this.currentImage=1,this.animatedWindow=null,this.loadWindowInteraction=null,this.bestResultsWindow=null,this.isBestResultsWindowActive=!1,this.bestResMax=10,this.isSavedGamesWindowActive=!1,this.matrixDimensionX=null,this.matrixDimensionY=null,this.mainElNum=null,this.defaultDimension=4,this.dem={mobile:{2:160,3:106,4:80,5:64,6:53,7:45,8:40},tablet:{2:218,3:146,4:109,5:87,6:73,7:63,8:55},desktop:{2:218,3:146,4:109,5:87,6:73,7:63,8:55}},this.isMobile=!1,this.initIsMobile(),this.setDimentionXY(),this.setMainElNum(),this.offset=null,this.setOffset(),this.matrix=[],this.shuffledMatrix=[],this.stepMatrix=[],this.shuffledMatrixEvenSumm=0,this.stepBtn=null,this.bestResBtnObj=null,this.soundBtn=null,this.soundObj=null,this.isSound=!0,this.autoStepSpeed=500,this.isAutoMode=!1,this.autoFnID=null,this.elArr=[],this.elArrN=[],this.styleSheet=null,this.setStyleSheet(),this.img={imagesPath:"",imagesAmount:150,images:{}},this.storeDataKey="storedatafdfa",this.bestResDataKey="storeresfdfa"}checkShuffledMatrix(){let t=!0;return this.shuffledMatrix.forEach(((e,s)=>{this.getCurrentElNum(e)!==s+1&&(t=!1)})),t}makeOrderArr(){let t=0,e=this.matrixDimensionX,s=0;this.elArr=[];const i=Object.keys(this.matrix).length;for(let o=0;o<i;o++)(o+1)%this.matrixDimensionX==0?(this.elArrN.push([1,o+1]),e-=1,t+=1,this.makeVerticalRow(this.matrixDimensionX,t,e),o+=1+s,s+=1):this.elArrN.push([1,o+1])}makeVerticalRow(t,e,s){let i=e,o=s;for(;o;)this.elArrN.push([2,t*i+e]),i++,o--}makeAISteps(){let t,e=0,s=1,i=0;this.makeOrderArr();const o=this.elArrN,n=this;let a;this.autoFnID=setInterval((()=>{0===e&&(o[i]?(a=n.stepsCompute(o[i][1],s,o[i][0]),t=n.stepMatrix.length):e=0),0===n.stepMatrix.length&&(e=t),a&&(e=t),n.isAutoMode||(clearInterval(n.autoFnID),n.stepMatrix=[]),e===t?(s+=1,this.stepMatrix=[],e=0,s>4&&(o[i]?(i+=1,s=1):(clearInterval(n.autoFnID),n.isAutoMode=!1))):(e+=1,0!==n.stepMatrix.length&&n.makeStep(n.stepMatrix[e-1][1],n.stepMatrix[e-1][0]))}),this.autoStepSpeed)}tempGetDirection(t){switch(t){case 1:return"TOP";case 2:return"RIGHT";case 3:return"BOTTOM";case 4:return"LEFT"}return!1}initIsMobile(){(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<480&&(this.isMobile=!0)}getBackGroundSize(){return this.getOffset()*this.matrixDimensionX}getBackGroundSizeCSS(){const t=this.getBackGroundSize();return`background-size: ${t}px ${t}px;`}setOffset(){this.offset=this.isMobile?this.dem.mobile[this.matrixDimensionX]:this.dem.desktop[this.matrixDimensionX]}getOffset(){return this.offset}isElOnItsTopRow(t){return this.isElOnPropPosY(t)}isElOnItsLeftCol(t){return this.isElOnPropPosX(t)}getBoxElNumViaCurrElNum(t){return this.getElNumViaLeftTopPos(this.getPosX(t),this.getPosY(t))}getCurrentElNumN(t){return parseInt(this.getPosX(t)/this.getOffset(),10)+1+parseInt(this.getPosY(t)/this.getOffset(),10)*this.matrixDimensionY}setCurrentMatrixN(){Object.keys(this.matrix).forEach(((t,e)=>{this.shuffledMatrix[this.getCurrentElNumN(e+1)-1]=e+1}))}getDestElNumByDirection(t){switch(t){case"top":case 1:return-1*this.matrixDimensionX;case"right":case 2:return 1;case"bottom":case 3:return this.matrixDimensionX;case"left":case 4:default:return-1}}setShffldOnElNumAndGooo(t,e="left"){const s=parseInt(this.getDestElNumByDirection(e),10);if(t!==this.mainElNum&&!this.isDrgbl(t,e))return;if(t===this.mainElNum&&!this.isMelDrgbl(e))return;let i=!1,o=0;this.shuffledMatrix.forEach(((e,n)=>{e===t&&0===o?this.shuffledMatrix[n+s]?(this.shuffledMatrix[n]=this.shuffledMatrix[n+s],this.shuffledMatrix[n+s]=e,o++):i=!0:this.shuffledMatrix[n]=e})),i||this.shuffle("notShuffle")}getCountOfStepsToPropYPos(t){return this.matrix[t-1].y/this.getOffset()-this.getYInitElementPosInsidMatrix(t)}toBottom(t){if(this.setMElUnder(t),0===this.stepMatrix.length)return;let e=-1*this.getCountOfStepsToPropYPos(t)-1;for(this.addStep(t,3);e>0;)this.isElLastOnRow(t)?(this.goMountOfSteps("left",1),this.goMountOfSteps("bottom",2),this.goMountOfSteps("right",1)):(this.goMountOfSteps("right",1),this.goMountOfSteps("bottom",2),this.goMountOfSteps("left",1)),this.addStep(t,3),e--}setMElUnder(t){if(!this.isElOnPropPosY(t))if(this.isMElBefore(t)){if(this.isMElOnTheSameRow(t)&&this.stepsToRight(t)>=0)return this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),this.goMountOfSteps("bottom",1),void this.goMountOfSteps("right",1);if(this.isMElOnTheSameRow(t)&&this.stepsToLeftt(t)>=0)return this.goMountOfSteps("left",this.getMountOfSteps(t,"right")-1),this.goMountOfSteps("bottom",1),void this.goMountOfSteps("left",1);if(this.isElLastOnRow(t)&&this.isMElOnTheSameCol(t))return this.goMountOfSteps("bottom",this.getMountOfSteps(t,"bottom")-1),this.goMountOfSteps("left",1),this.goMountOfSteps("bottom",1),void this.goMountOfSteps("right",1);if(this.isMElOnTheSameCol(t))return this.goMountOfSteps("bottom",this.getMountOfSteps(t,"bottom")-1),this.goMountOfSteps("right",1),this.goMountOfSteps("bottom",1),void this.goMountOfSteps("left",1);this.stepsToBottom(t)>0&&this.stepsToRight(t)>=0&&(this.goMountOfSteps("bottom",this.getMountOfSteps(t,"bottom")),this.goMountOfSteps("right",this.getMountOfSteps(t,"right"))),this.stepsToBottom(t)>0&&this.stepsToLeft(t)>=0&&(this.goMountOfSteps("bottom",this.getMountOfSteps(t,"bottom")),this.goMountOfSteps("left",this.getMountOfSteps(t,"left")))}else{if(this.isMElOnTheSameRow(t)&&this.stepsToLeft(t)>=0)return this.goMountOfSteps("left",this.getMountOfSteps(t,"left")-1),this.goMountOfSteps("bottom",1),void this.goMountOfSteps("left",1);if(this.isMElOnTheSameCol(t))return void this.goMountOfSteps("top",this.getMountOfSteps(t,"top")-1);this.stepsTotop(t)>=0&&this.stepsToRight(t)>=0&&(this.goMountOfSteps("right",this.getMountOfSteps(t,"right")),this.goMountOfSteps("top",this.getMountOfSteps(t,"top")-1)),this.stepsTotop(t)>=0&&this.stepsToLeft(t)>=0&&(this.goMountOfSteps("left",this.getMountOfSteps(t,"left")),this.goMountOfSteps("top",this.getMountOfSteps(t,"top")-1))}}toTop(t,e){if(this.setMElAbove(t,e),0===this.stepMatrix.length)return;let s=this.getCountOfStepsToPropYPos(t)-1;for(this.addStep(t,1);s>0;)this.isElLastOnRow(t)?(this.goMountOfSteps("left",1),this.goMountOfSteps("top",2),this.goMountOfSteps("right",1)):(this.goMountOfSteps("right",1),this.goMountOfSteps("top",2),this.goMountOfSteps("left",1)),this.addStep(t,1),s--;this.isItPreLastElInRow(t)&&(this.goMountOfSteps("right",1),this.goMountOfSteps("top",1),this.addStep(t,2))}isElAfterItsPropCol(t){return this.matrix[t-1].y<this.getYPXPosition(t)}setMElAbove(t,e){if(!this.isElOnPropPosY(t)&&!this.isElAfterItsPropCol(t))if(this.isMElBefore(t)){if(this.isCaseRangedRowAbove(t)&&2===e)return;if(this.isCaseRangedRowAbove(t)){if(this.stepsToRight(t)>=0){if(this.isElLastOnRow(t))return this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),this.goMountOfSteps("top",1),void this.goMountOfSteps("right",1);this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),this.goMountOfSteps("bottom",1),this.goMountOfSteps("right",2),this.goMountOfSteps("top",2),this.goMountOfSteps("left",1)}return}if(this.isMElOnTheSameRow(t)&&this.stepsToRight(t)>=0)return this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),this.goMountOfSteps("top",1),void this.goMountOfSteps("right",1);this.stepsToBottom(t)>0&&this.goMountOfSteps("bottom",this.getMountOfSteps(t,"bottom")-1),this.stepsToRight(t)>=0&&this.goMountOfSteps("right",this.getMountOfSteps(t,"right")),this.stepsToLeft(t)>=0&&this.goMountOfSteps("left",this.getMountOfSteps(t,"left"))}else{if(this.isMElOnTheSameRow(t))return void(this.stepsToLeft(t)>=0&&(this.goMountOfSteps("left",this.getMountOfSteps(t,"left")-1),this.goMountOfSteps("top",1),this.goMountOfSteps("left",1)));if(this.isMElOnTheSameCol(t))return void(this.isMElCanMoveToTheRight()?(this.goMountOfSteps("right",1),this.goMountOfSteps("top",this.getMountOfSteps(t,"top")+1),this.goMountOfSteps("left",1)):(this.goMountOfSteps("left",1),this.goMountOfSteps("top",this.getMountOfSteps(t,"top")+1),this.goMountOfSteps("right",1)));if(this.isCaseRangedRowAbove(t))return this.stepsTotop(t)>=0&&this.goMountOfSteps("top",this.getMountOfSteps(t,"top")-1),this.stepsToRight(t)>=0&&this.goMountOfSteps("right",this.getMountOfSteps(t,"right")),this.stepsToLeft(t)>=0&&this.goMountOfSteps("left",this.getMountOfSteps(t,"left")),this.goMountOfSteps("right",1),this.goMountOfSteps("top",2),void this.goMountOfSteps("left",1);this.stepsTotop(t)>=0&&this.goMountOfSteps("top",this.getMountOfSteps(t,"top")-1),this.stepsToRight(t)>=0&&this.goMountOfSteps("right",this.getMountOfSteps(t,"right")),this.stepsToLeft(t)>=0&&this.goMountOfSteps("left",this.getMountOfSteps(t,"left")),this.goMountOfSteps("left",1),this.goMountOfSteps("top",2),this.goMountOfSteps("right",1)}}getCountOfStepsToPropXPos(t){return this.matrix[t-1].x/this.getOffset()-this.getXInitElementPosInsideMatrix(t)}toLeft(t,e){if(this.setMElBefore(t),0===this.stepMatrix.length)return;let s=this.getCountOfStepsToPropXPos(t)-1;for(this.addStep(t,4);s>0;)this.isThereAbilityToGoByBottom(t)?(this.goMountOfSteps("bottom",1),this.goMountOfSteps("left",2),this.goMountOfSteps("top",1)):(this.goMountOfSteps("top",1),this.goMountOfSteps("left",2),this.goMountOfSteps("bottom",1)),this.addStep(t,4),s--;2===e&&this.isItPreLastElInCol(t)&&(this.goMountOfSteps("bottom",1),this.goMountOfSteps("left",1),this.addStep(t,3))}isItPreLastElInCol(t){return this.getYInitElementPosInsidMatrix(t)+1===this.matrixDimensionY-1}isElBeforeItsPropRow(t){return this.matrix[t-1].x<this.getXPXPosition(t)}setMElBefore(t){if(this.isElOnPropPosX(t))return!1;if(this.isElBeforeItsPropRow(t))return!1;let e=!1;if(this.isMElBefore(t)){if(this.isMElOnTheSameRow(t)&&this.stepsToRight(t)>=0)return this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),!0;if(this.isMElOnTheSameCol(t)&&this.stepsToBottom(t)>=0)return this.goMountOfSteps("bottom",this.getMountOfSteps(t,"bottom")-1),this.goMountOfSteps("left",1),this.goMountOfSteps("bottom",1),!0;this.stepsToBottom(t)>=0?(this.goMountOfSteps("bottom",this.getMountOfSteps(t,"bottom")-1),this.stepsToRight(t)>=0&&this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),this.stepsToLeft(t)>=0&&this.goMountOfSteps("left",this.getMountOfSteps(t,"left")+1),this.goMountOfSteps("bottom",1),e=!0):(this.stepsToRight(t)>=0&&(this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),e=!0),this.stepsToLeft(t)>=0&&(this.goMountOfSteps("left",this.getMountOfSteps(t,"left")+1),e=!0),this.stepsToBottom(t)>=0&&(this.goMountOfSteps("bottom",this.getMountOfSteps(t,"bottom")),e=!0))}else{if(this.isMElOnTheSameRow(t))return this.isMElCanMoveToTheBottom()?(this.goMountOfSteps("bottom",1),this.goMountOfSteps("left",this.getMountOfSteps(t,"left")+1),this.goMountOfSteps("top",1),!0):(this.goMountOfSteps("top",1),this.goMountOfSteps("left",this.getMountOfSteps(t,"left")+1),this.goMountOfSteps("bottom",1),!0);if(this.isMElOnTheSameCol(t))return this.goMountOfSteps("left",1),this.goMountOfSteps("top",this.getMountOfSteps(t,"top")),!0;this.stepsToRight(t)>=0&&(this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),e=!0),this.stepsToLeft(t)>=0&&(this.goMountOfSteps("left",this.getMountOfSteps(t,"left")+1),e=!0),this.stepsTotop(t)>=0&&(this.goMountOfSteps("top",this.getMountOfSteps(t,"top")),e=!0)}return e}isElLastOnRow(t){return this.getXInitElementPosInsideMatrix(t)+1===this.matrixDimensionX}isItPreLastElInRow(t){return this.getXInitElementPosInsideMatrix(t)+1===this.matrixDimensionX-1}toRight(t){if(!this.setMElAfter(t))return;let e=-1*this.getCountOfStepsToPropXPos(t)-1;for(this.addStep(t,2);e>0;)this.isThereAbilityToGoByBottom(t)?(this.goMountOfSteps("bottom",1),this.goMountOfSteps("right",2),this.goMountOfSteps("top",1)):(this.goMountOfSteps("top",1),this.goMountOfSteps("right",2),this.goMountOfSteps("bottom",1)),this.addStep(t,2),e--}isCaseRangedRowAbove(t){return this.matrix[t-1].x<=this.getXPXPosition(t)&&this.matrix[t-1].y-this.getOffset()===this.getYPXPosition(t)}setMElAfter(t){if(this.isElOnPropPosX(t))return!1;if(!this.isElBeforeItsPropRow(t))return!1;let e=!1;if(this.isMElBefore(t)){if(this.isCaseRangedRowAbove(t)){if(this.stepsToRight(t)>=0)return this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),this.goMountOfSteps("bottom",1),this.goMountOfSteps("right",2),this.goMountOfSteps("top",2),!0;if(this.stepsToLeft(t)>=0)return this.goMountOfSteps("bottom",1),this.goMountOfSteps("left",this.getMountOfSteps(t,"left")-1),!0}if(this.isMElOnTheSameRow(t)&&this.stepsToRight(t)>=0)return this.goMountOfSteps("right",this.getMountOfSteps(t,"right")-1),this.goMountOfSteps("top",1),this.goMountOfSteps("right",2),this.goMountOfSteps("bottom",1),!0;if(this.stepsToBottom(t)>=0&&(this.goMountOfSteps("bottom",this.getMountOfSteps(t,"bottom")-1),e=!0),this.isMElOnTheSameCol(t))return this.goMountOfSteps("right",1),this.goMountOfSteps("bottom",1),!0;this.stepsToRight(t)>=0&&(this.goMountOfSteps("right",this.getMountOfSteps(t,"right")+1),this.goMountOfSteps("bottom",1),e=!0),this.stepsToLeft(t)>=0&&(this.goMountOfSteps("left",this.getMountOfSteps(t,"left")-1),this.goMountOfSteps("bottom",1),e=!0)}else{if(this.isMElOnTheSameRow(t)&&this.stepsToLeft(t)>=0)return this.goMountOfSteps("left",this.getMountOfSteps(t,"left")-1),!0;if(this.isMElOnTheSameCol(t)&&this.isMElCanMoveToTheRight())return this.goMountOfSteps("right",1),this.goMountOfSteps("top",this.getMountOfSteps(t,"top")),!0;this.stepsTotop(t)>=0&&(this.goMountOfSteps("top",this.getMountOfSteps(t,"top")-1),e=!0),this.stepsToRight(t)>=0&&(this.goMountOfSteps("right",this.getMountOfSteps(t,"right")),e=!0),this.stepsToLeft(t)>=0&&(this.goMountOfSteps("left",this.getMountOfSteps(t,"left")),e=!0),e&&(this.goMountOfSteps("right",1),this.goMountOfSteps("top",1))}return e}addStep(t,e){this.stepMatrix.push([t,e])}makeStep(t,e=this.mainElNum){switch(t){case 1:case"top":this.setShffldOnElNumAndGooo(e,"top");break;case 2:case"right":this.setShffldOnElNumAndGooo(e,"right");break;case 3:case"bottom":this.setShffldOnElNumAndGooo(e,"bottom");break;case 4:case"left":if(e!==this.mainElNum&&this.isDrggblToLeft(e)){this.setShffldOnElNumAndGooo(e);break}this.setShffldOnElNumAndGooo(e)}}getMountOfSteps(t,e){switch(e){case"top":return this.getElRowNum(this.mainElNum)-this.getElRowNum(t);case"right":return this.getElColNum(t)-this.getElColNum(this.mainElNum);case"bottom":return this.getElRowNum(t)-this.getElRowNum(this.mainElNum);case"left":return this.getElColNum(this.mainElNum)-this.getElColNum(t);default:return!1}}goMountOfSteps(t,e){for(let s=0;s<e;s++)switch(t){case"top":this.addStep(this.mainElNum,1);break;case"right":this.addStep(this.mainElNum,2);break;case"bottom":this.addStep(this.mainElNum,3);break;case"left":this.addStep(this.mainElNum,4)}}getElRowNum(t){return this.matrix[t-1].y/this.getOffset()+1}getElColNum(t){return this.matrix[t-1].x/this.getOffset()+1}isMElBefore(t){return this.getCurrentElNumN(this.mainElNum)<this.getCurrentElNumN(t)}isOnPropRow(t){return this.isElOnPropPosY(t)}isOnPropCol(t){return this.isElOnPropPosX(t)}isMElOnTheSameRow(t){return this.matrix[this.mainElNum-1].y===this.matrix[t-1].y}isMElOnTheSameCol(t){return this.matrix[this.mainElNum-1].x===this.matrix[t-1].x}isMElCanMoveToTheRight(){return this.getCurrentElNumN(this.mainElNum)%this.matrixDimensionX!=0}isMElCanMoveToTheLeft(){return(this.getCurrentElNumN(this.mainElNum)-1)%this.matrixDimensionX!=0}isMElCanMoveToTheTop(){return 0!==this.matrix[this.mainElNum-1].y}isMElCanMoveToTheBottom(){return this.matrix[this.mainElNum-1].y<(this.matrixDimensionY-1)*this.getOffset()}isThereAbilityToGoByBottom(t){return this.matrix[t-1].y<(this.matrixDimensionY-1)*this.getOffset()}isDrgbl(t,e){switch(e){case 1:case"top":return this.isDrggblToTop(t);case 2:case"right":return this.isDrggblToRight(t);case 3:case"bottom":return this.stepsToBottom(t);case 4:case"left":return this.isDrggblToLeft(t)}return!1}isMelDrgbl(t){switch(t){case 1:case"top":return this.isMElCanMoveToTheTop();case 2:case"right":return this.isMElCanMoveToTheRight();case 3:case"bottom":return this.isMElCanMoveToTheBottom();case 4:case"left":return this.isMElCanMoveToTheLeft()}return!1}isDrggblToTop(t){return this.isElMain(this.getTopElNum(t))}isDrggblToBottom(t){return this.isElMain(this.getBottomElNum(t))}isDrggblToLeft(t){return this.isElMain(this.getLeftElNum(t))}isDrggblToRight(t){return this.isElMain(this.getRightElNum(t))}stepsToBottom(t){return this.getMountOfSteps(t,"bottom")-1}stepsTotop(t){return this.getMountOfSteps(t,"top")-1}stepsToRight(t){return this.getMountOfSteps(t,"right")-1}stepsToLeft(t){return this.getMountOfSteps(t,"left")-1}stepsCompute(t,e,s){if(this.setCurrentMatrixN(),this.isElOnPropPos(t))return!0;switch(this.getPropDir(e,s)){case 1:this.toTop(t,s);break;case 2:this.toRight(t,s);break;case 3:this.toBottom(t,s);break;case 4:this.toLeft(t,s)}return!1}getPropDir(t,e){if(2===e)switch(t){case 1:return 1;case 2:return 3;case 3:return 4}switch(t){case 1:return 4;case 2:return 2;case 3:return 1}return!1}araseMatrix(){this.matrix=[]}setDimentionXY(t){this.matrixDimensionX=t||this.defaultDimension,this.matrixDimensionY=this.matrixDimensionX,this.setMainElNum()}getElObj(t){return{x:this.getXPXPosition(t),y:this.getYPXPosition(t),ownNum:t,isMain:t===this.getMatrixDimension()}}getXInitElementPosInsideMatrix(t){return(t-1)%this.matrixDimensionX}getYInitElementPosInsidMatrix(t){return parseInt((t-1)/this.matrixDimensionX,10)}getYPXPosition(t){return this.getYInitElementPosInsidMatrix(t)*this.getOffset()}getXPXPosition(t){return this.getXInitElementPosInsideMatrix(t)*this.getOffset()}setPosY(t,e){this.matrix[t-1].y=e}setPosX(t,e){this.matrix[t-1].x=e}setMatrixDimensionX(t){this.matrixDimensionX=t}getMatrixDimension(){return this.matrixDimensionX*this.matrixDimensionY}setMainElNum(){this.mainElNum=this.getMatrixDimension()}getMainElID(){return"elID_"+this.mainElNum}addElObjToMatrix(t){this.matrix.push(this.getElObj(t))}makeShuffledMatrix(){for(let t=1,e=this.getMatrixDimension();t<=e;t++)this.shuffledMatrix.push(t);this.shuffledMatrix.sort((()=>Math.random()-.5))}makeAllObj(){this.makeShuffledMatrix();for(let t=1,e=this.getMatrixDimension();t<=e;t++)this.addElObjToMatrix(t)}getElLeftTopCSSProp(t){return`left: ${this.getXPXPosition(t)}px; top: ${this.getYPXPosition(t)}px;`}getElBgPosCSSProp(t){return`${this.getBackGroundSizeCSS()} background-position: -${this.getXPXPosition(t)}px -${this.getYPXPosition(t)}px;`}isElMain(t){return!!t&&this.matrix[t-1].isMain}getElNumViaLeftTopPos(t,e){try{return this.matrix.find((s=>s.x===t&&s.y===e)).ownNum}catch(t){return!1}}getPosX(t){return this.matrix[t-1].x}getPosY(t){return this.matrix[t-1].y}getTopElNum(t){return this.getElNumViaLeftTopPos(this.getPosX(t),this.getPosY(t)-this.getOffset())}getRightElNum(t){return this.getElNumViaLeftTopPos(this.getPosX(t)+this.getOffset(),this.getPosY(t))}getBottomElNum(t){return this.getElNumViaLeftTopPos(this.getPosX(t),this.getPosY(t)+this.getOffset())}getLeftElNum(t){return this.getElNumViaLeftTopPos(this.getPosX(t)-this.getOffset(),this.getPosY(t))}render(){this.makeNoMatrixElmnts(),this.showMatrix(),this.mainUsrController()}startTimer(){this.isPaused=!1;const t=!!this.getTimerVal()&&this.getTimerVal().split(":");let e=t?parseInt(t[2],10):0,s=t?parseInt(t[1],10):0,i=t?parseInt(t[0],10):0;const o=this.timer;this.timerID=setInterval((()=>{e+=1,e>=60&&(s+=1,e=0),s>=60&&(i+=1,s=0),o.innerText=`${i.toString().length<2?"0"+i:i}:${s.toString().length<2?"0"+s:s}:${e.toString().length<2?"0"+e:e}`}),1e3)}getTimerVal(){return this.timerVal}setTimerVal(){this.timerVal=this.timer.innerText}resetTimer(){this.timerVal=null,this.startTimer()}pauseGame(){if(!this.isPaused)return this.isPaused=!0,this.setTimerVal(),void clearInterval(this.timerID);this.isPaused=!1,this.startTimer()}setStyleSheet(){if(null!==this.styleSheet)return;const t=document.styleSheets;for(let e=0,s=t.length;e<s;e++)for(let s=0,i=t[e].cssRules.length;s<i;s++)if(".main-container"===t[e].cssRules[s].selectorText)return void(this.styleSheet=t[e])}getClassRule(t){for(let e=0,s=this.styleSheet.cssRules.length;e<s;e++)if(this.styleSheet.cssRules[e].selectorText===t)return this.styleSheet.cssRules[e];return!1}setClassRule(t,e){this.getClassRule(t)||this.styleSheet.insertRule(t+"{}",this.styleSheet.cssRules.length),this.getClassRule(t).style.cssText=e}setCSSProperty(t,e,s){this.getClassRule(t)||this.styleSheet.insertRule(t+"{}",this.styleSheet.cssRules.length),this.getClassRule(t).style[e]=s}changeCSSClass(t,e,s,i){const o=document.getElementById(t);o.classList.remove(e+s),o.classList.add(e+i)}makeAllParts(){this.mainContainer||(this.el=this.createElNode("div","mainContainer","main-container pos"),this.setCSSProperty(".pos","top",`calc(50% - ${this.getBackGroundSize()}px/2)`),this.setCSSProperty(".pos","left",`calc(50% - ${this.getBackGroundSize()}px/2)`),this.appendToMain(this.el),this.mainContainer=document.getElementById("mainContainer")),this.makeAllObj(),this.matrix.forEach((t=>{this.setClassRule(".cube-position"+t.ownNum,""+this.getElLeftTopCSSProp(t.ownNum)),this.setClassRule(".cube-bg"+t.ownNum,this.getElCSS(t.ownNum)),this.innerEl=document.createElement("div"),this.innerEl.id="elID_"+t.ownNum,this.innerEl.dataset.elNum=t.ownNum,this.innerEl.classList=`cube-position${t.ownNum} cube-bg${t.ownNum}`,this.innerEl.textContent=t.ownNum,this.mainContainer.appendChild(this.innerEl)}))}createElNode(t,e="",s="",i="",o="",n=""){const a=document.createElement(t);return""!==e&&(a.id=e),""!==o&&(a.dataset[o]=n),""!==s&&(a.classList=s),""!==i&&(a.textContent=i),a}appendToMain(t){this.mainEl||(this.mainEl=document.getElementById("main")),this.mainEl.appendChild(t)}makeDimensionSelect(){const t=this.createElNode("select","dimSelect","selects");Object.keys(this.isMobile?this.dem.mobile:this.dem.desktop).forEach((e=>{this.el=this.createElNode("option","","",`${e}x${e}`,"dim",e),e.toString()===this.defaultDimension.toString()&&(this.el.selected=!0),t.appendChild(this.el)})),this.sattingsBoardContainer.appendChild(t)}makeImagesSelect(){const t=this.createElNode("select","imgSelect","selects");for(let e=1;e<=this.img.imagesAmount;e++)this.el=this.createElNode("option","","","image "+e,"dim",e),t.appendChild(this.el);this.sattingsBoardContainer.appendChild(t)}makeHeader(){this.appendToMain(this.createElNode("h1","","",this.string[this.lang].gemPuzzle))}makeResetBtn(){this.gameBoardContainer.appendChild(this.createElNode("div","resetBtn","btn centered",this.string[this.lang].resetBtn))}makeGameDashBoard(){this.appendToMain(this.createElNode("div","dashBoardContainer","dash dash-pos"));const t=this.getBackGroundSize();this.setClassRule(".dash-pos",`width: ${t}px; left: calc(50% - ${t}px/2); top: calc(50% - ${t-(t>320?180:120)}px);`),this.dashBoardContainer=document.getElementById("dashBoardContainer")}makeSettingsDash(){this.appendToMain(this.createElNode("div","sattingsBoardContainer","dash sattings-board-container")),this.sattingsBoardContainer=document.getElementById("sattingsBoardContainer")}makeGameDash(){this.appendToMain(this.createElNode("div","gameBoardContainer","dash sattings-board-container game-top-mod")),this.gameBoardContainer=document.getElementById("gameBoardContainer")}makeTimer(){this.dashBoardContainer.appendChild(this.createElNode("div","timer","centered","00:00:00")),this.timer=document.getElementById("timer")}makeStopStartTimerBtn(){this.dashBoardContainer.appendChild(this.createElNode("div","stopStartBtn","btn centered",this.string[this.lang].startBtn)),this.stopStartBtn=document.getElementById("stopStartBtn")}makeStepNumber(){this.dashBoardContainer.appendChild(this.createElNode("div","steps","centered",this.string[this.lang].step+"0")),this.stepCounterObj=document.getElementById("steps")}makeSaveBtn(){this.gameBoardContainer.appendChild(this.createElNode("div","saveBtn","btn centered",this.string[this.lang].saveBtn))}makeLoadBtn(){this.gameBoardContainer.appendChild(this.createElNode("div","loadBtn","btn centered",this.string[this.lang].loadBtn))}bestResBtn(){this.gameBoardContainer.appendChild(this.createElNode("div","bestResBtn","btn centered",this.string[this.lang].bestResBtn)),this.bestResBtnObj=document.getElementById("bestResBtn")}makeIsSolvingHint(){this.appendToMain(this.createElNode("div","solvingHint","solving-hint centered")),this.solvingHint=document.getElementById("solvingHint")}makeIsWinHint(){this.appendToMain(this.createElNode("div","winHint","win-hint centered")),this.winHint=document.getElementById("winHint")}makeImagesDescribe(){this.appendToMain(this.createElNode("div","imagesDescribe","win-hint images-describe centered")),this.imagesDescribe=document.getElementById("imagesDescribe")}makeSoundBtn(){this.sattingsBoardContainer.appendChild(this.createElNode("div","soundBtn","btn centered",this.string[this.lang].soundBtn)),this.soundBtn=document.getElementById("soundBtn")}makeSoundField(){const t=this.createElNode("audio","sound1","sound-1");t.src="sounds/sound1.wav",this.appendToMain(t),this.soundObj=document.getElementById("sound1")}makeAIStepBtn(){this.dashBoardContainer.appendChild(this.createElNode("div","stepBtn","btn centered",this.string[this.lang].stepBtn)),this.stepBtn=document.getElementById("stepBtn")}makeAnimatedWindow(){this.appendToMain(this.createElNode("div","animatedWindow","animated-window")),this.animatedWindow=document.getElementById("animatedWindow")}makeLoadWindowInteraction(){this.appendToMain(this.createElNode("div","loadWindowInteraction","interact-window")),this.loadWindowInteraction=document.getElementById("loadWindowInteraction")}makeBestResultsWindow(){this.appendToMain(this.createElNode("div","bestResultsWindow","interact-window")),this.bestResultsWindow=document.getElementById("bestResultsWindow")}getElCSS(t){const e=t===this.getMatrixDimension()?"z-index: 0; opacity: 0;":"z-index: 1; opacity: 1;";return`${this.getElBgPosCSSProp(t)} width: ${this.getOffset()}px; height: ${this.getOffset()}px; line-height: ${this.getOffset()}px; ${e}`}makeNoMatrixElmnts(){this.makeAnimatedWindow(),this.makeHeader(),this.makeSettingsDash(),this.makeDimensionSelect(),this.makeImagesSelect(),this.makeSoundBtn(),this.makeSoundField(),this.makeGameDash(),this.makeResetBtn(),this.makeSaveBtn(),this.makeLoadBtn(),this.bestResBtn(),this.makeGameDashBoard(),this.makeTimer(),this.makeStopStartTimerBtn(),this.makeStepNumber(),this.makeAIStepBtn(),this.makeIsSolvingHint(),this.makeIsWinHint(),this.makeImagesDescribe(),this.makeLoadWindowInteraction(),this.makeBestResultsWindow()}showMatrix(){this.makeAllParts(),this.shuffle(),document.querySelectorAll("[data-el-num]").forEach((t=>{this.dragElementInit(t)}))}setAllPartsInItsPos(){let t;this.matrix.forEach(((e,s)=>{t=document.getElementById("elID_"+(s+1)),this.setPosX(s+1,this.getXPXPosition(s+1)),this.setPosY(s+1,this.getYPXPosition(s+1)),t.className="wbrdr box-text-color cube-bg"+(s+1),t.classList.add("cube-position"+(s+1))}))}isPairEven(t,e){for(let s=t,i=this.shuffledMatrix.length;s<i;s++)e>this.shuffledMatrix[s]&&e!==this.getMatrixDimension()&&(this.shuffledMatrixEvenSumm+=1,this.tempLog=`${this.tempLog}${e} > ${this.shuffledMatrix[s]}\n`)}isShuffledMatrixSolving(){return this.shuffledMatrixEvenSumm=0,this.shuffledMatrix.forEach(((t,e)=>{this.isPairEven(e,t),this.tempLog=""})),this.getMatrixDimension()%2==0?(this.shuffledMatrixEvenSumm=this.shuffledMatrixEvenSumm+this.matrix[this.getMatrixDimension()-1].y/this.getOffset()+1,this.shuffledMatrixEvenSumm%2==0):this.shuffledMatrixEvenSumm%2==0}shuffle(t=!1){this.shuffledMatrix.forEach(((t,e)=>{this.shuffleFnMakeStep(t,e+1)})),this.setCSSProperty(".cube-bg"+this.getMatrixDimension(),"opacity",0),t||(this.isShuffledMatrixSolving()||(this.resetShuffledMatrix(),this.shuffle()),this.winHint.innerText="",this.imagesDescribe.innerText="")}shuffleFnMakeStep(t,e){const s=document.getElementById("elID_"+t);s.className="wbrdr box-text-color cube-bg"+t,s.classList.add("cube-position"+e),this.setPosX(t,this.getXPXPosition(e)),this.setPosY(t,this.getYPXPosition(e))}resetShuffledMatrix(){this.shuffledMatrix=[],this.makeShuffledMatrix(),this.winHint.innerText="",this.imagesDescribe.innerText=""}getCurrentElNum(t){return parseInt(this.getPosX(t)/this.getOffset(),10)+1+parseInt(this.getPosY(t)/this.getOffset(),10)*this.matrixDimensionY}getRightCurrentElNum(t){return parseInt((this.getPosX(t)+this.getOffset())/this.getOffset(),10)+1+parseInt(this.getPosY(t)/this.getOffset(),10)*this.matrixDimensionY}getLeftCurrentElNum(t){return parseInt((this.getPosX(t)-this.getOffset())/this.getOffset(),10)+1+parseInt(this.getPosY(t)/this.getOffset(),10)*this.matrixDimensionY}getBottomCurrentElNum(t){return parseInt(this.getPosX(t)/this.getOffset(),10)+1+parseInt((this.getPosY(t)+this.getOffset())/this.getOffset(),10)*this.matrixDimensionY}getTopCurrentElNum(t){return parseInt(this.getPosX(t)/this.getOffset(),10)+1+parseInt((this.getPosY(t)-this.getOffset())/this.getOffset(),10)*this.matrixDimensionY}changDrgblClass(t,e,s,i){this.changeCSSClass(t,e,s,i),this.changeCSSClass(this.getMainElID(),e,i,s)}changeObPosVal(e){const s=this.getPosX(this.getMatrixDimension()),i=this.getPosY(this.getMatrixDimension());this.setPosX(this.getMatrixDimension(),this.getPosX(e)),this.setPosY(this.getMatrixDimension(),this.getPosY(e)),this.setPosX(e,s),this.setPosY(e,i),"win"===this.isUserWin()&&(this.winHint.innerText=`${this.string[this.lang].winSlug1} ${this.step} ${this.string[this.lang].winSlug2} ${document.getElementById("timer").innerText}`,this.imagesDescribe.innerText=`${t[this.currentImage-1].author}, ${t[this.currentImage-1].name} ${t[this.currentImage-1].year}`,this.setCSSProperty(".cube-bg"+this.getMatrixDimension(),"opacity",1),document.getElementById(this.getMainElID()).classList.add("animated"),document.querySelectorAll("[data-el-num]").forEach((t=>{t.classList.remove("box-text-color"),t.classList.add("box-text-color-trnsprnt"),t.classList.remove("wbrdr")})),this.setBestResLS(`{"dim":"${this.matrixDimensionX}", "image":"${this.currentImage-1}", "steps":"${this.step}", "time":"${document.getElementById("timer").innerText}"}`),this.isPaused=!0,clearInterval(this.timerID))}setBestResLS(t){let e=localStorage.getItem(this.bestResDataKey);if(!e)return void localStorage.setItem(this.bestResDataKey,`{"0":${t}}`);e=JSON.parse(e);let s=Object.keys(e);const i=JSON.parse(t);let o=0,n=!0;if(s.forEach(((t,s)=>{e[s]&&e[s].dim===i.dim&&e[s].steps===i.steps&&e[s].time===i.time&&(o++,n=!1)})),o<=this.bestResMax&&(e[s.length]=i,localStorage.setItem(this.bestResDataKey,JSON.stringify(e))),n)return e[s.length]=i,void localStorage.setItem(this.bestResDataKey,JSON.stringify(e));let a,r=!1;s.forEach(((o,n)=>{e[n]&&this.matrixDimensionX.toString()===e[n].dim&&(void 0===a&&(a=e[n].time),a=this.compareTime(e[n].time,a)?e[n].time:a,this.compareTime(e[n].time,i.time)&&!r&&(e[s.length]=JSON.parse(t),r=!0))})),void 0!==a&&r&&(s=Object.keys(e),s.forEach(((t,s)=>{e[s]&&this.matrixDimensionX.toString()===e[s].dim&&e[s].time===a&&delete e[s]}))),r&&localStorage.setItem(this.bestResDataKey,JSON.stringify(e))}compareTime(t,e){const s=t.split(":"),i=e.split(":"),o=new Date(2011,0,1,parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10)),n=new Date(2011,0,1,parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10));return o.getTime()>n.getTime()}getBestResLS(){this.isBestResultsWindowActive=!0;const t=JSON.parse(localStorage.getItem(this.bestResDataKey));this.bestResultsWindow.classList.add("displ-blck");let e=`<h3 class="best-res-header centered">THE BEST OF THE BEST (${this.matrixDimensionX}x${this.matrixDimensionX})</h3>`;t&&Object.keys(t).forEach(((s,i)=>{t[i]&&this.matrixDimensionX.toString()===t[i].dim&&(e+=`<div class="best-res-item centered">time: ${t[i].time} steps: ${t[i].steps}</div>`)})),this.bestResultsWindow.innerHTML=e}loadGame(t){"object"==typeof t&&(clearInterval(this.timerID),this.clearSteps(),this.shuffledMatrix=[],this.shuffledMatrix=t.matrix.split(",").map((t=>parseInt(t,10))),this.shuffle(),this.step=parseInt(t.steps,10),this.timerVal=t.time,this.timer.innerText=t.time,this.currentImage=parseInt(t.image,10)+1,this.setCSSProperty(".main-container div","backgroundImage",`url("../images/${this.currentImage}.jpg")`),this.imagesDescribe.innerText="")}getSavedGamesLS(){this.isSavedGamesWindowActive=!0;const t=JSON.parse(localStorage.getItem(this.storeDataKey));this.loadWindowInteraction.classList.add("displ-blck");let e=`<h3 class="best-res-header centered">${this.string[this.lang].load} (${this.matrixDimensionX}x${this.matrixDimensionX})</h3>`;t&&Object.keys(t).forEach(((s,i)=>{t[i]&&this.matrixDimensionX.toString()===t[i].dim&&(e+=`<div class="best-res-item centered" data-set-game='${JSON.stringify(t[i])}'>${t[i].date}  image ${parseInt(t[i].image,10)+1}</div>`)})),this.loadWindowInteraction.innerHTML=`${e}<div id="closeLoadWindowInteractionBTN" class="close-LoadWindowInteraction-BTN">${this.string[this.lang].close}</div>`}getStringForSaveGame(t=0){const e=new Date,s=t?"":"}";return`${t?"":`{"${t}":`}{"date":"${e.getMonth().toString().length<2?"0"+e.getMonth():e.getMonth()}-${e.getDate().toString().length<2?"0"+e.getDate():e.getDate()} ${e.getHours().toString().length<2?"0"+e.getHours():e.getHours()}:${e.getMinutes().toString().length<2?"0"+e.getMinutes():e.getMinutes()}", "dim":"${this.matrixDimensionX}", "image":"${this.currentImage-1}", "steps":"${this.step}", "time":"${document.getElementById("timer").innerText}", "matrix":"${this.shuffledMatrix}"}${s}`}setCurrentGameLS(){this.setCurrentMatrixN();let t=localStorage.getItem(this.storeDataKey);if(null==t&&localStorage.setItem(this.storeDataKey,this.getStringForSaveGame()),t){t=JSON.parse(t);const e=Object.keys(t);let s="",i=!1,o=0;e.forEach(((e,s)=>{t[s]&&t[s].dim===this.matrixDimensionX.toString()&&o++})),o>=10&&(e.forEach(((e,i)=>{""===s&&(s=t[i].date),s=this.compareDateAndTime(t[i].date,s)?t[i].date:s})),""!==s&&e.forEach(((e,o)=>{t[o].date!==s||i||(t[o]=JSON.parse(this.getStringForSaveGame("get")),i=!0)}))),i||(t[e.length]=JSON.parse(this.getStringForSaveGame("get"))),localStorage.setItem(this.storeDataKey,JSON.stringify(t))}}compareDateAndTime(t,e){const s=t.split(" "),i=e.split(" "),o=s[0].split("-"),n=i[1].split("-"),a=i[1].split(":"),r=i[1].split(":"),h=new Date(2011,parseInt(o[0],10),parseInt(o[1],10),parseInt(a[0],10),parseInt(a[1],10)),u=new Date(2011,parseInt(n[0],20),parseInt(n[1],10),parseInt(r[0],10),parseInt(r[1],10));return h.getTime()>u.getTime()}isElOnPropPosX(t){return this.matrix[t-1].x===this.getXPXPosition(t)}isElOnPropPosY(t){return this.matrix[t-1].y===this.getYPXPosition(t)}isElOnPropPos(t){return this.isElOnPropPosX(t)&&this.isElOnPropPosY(t)}isUserWin(){if(this.isElOnPropPos(this.getMatrixDimension())){for(let t=0,e=this.matrix.length;t<e;t++)if(!this.isElOnPropPos(t+1))return!1;return"win"}return!1}clearSteps(){this.step=0,this.stepCounterObj.innerText=this.string[this.lang].step+"0"}changeStepCountNum(){this.step+=1,this.stepCounterObj.innerText=`${this.string[this.lang].step}${this.step}`}dragElementInit(t){const e=t;let s=0,i=0;function o(t){e.style.top=t.pageY-i/2+100+"px",e.style.left=t.pageX-s/2+100+"px"}function n(){e.removeAttribute("style"),document.onmouseup=null,document.onmousemove=null,document.ontouchend=null,document.ontouchmove=null}e&&(e.onmousedown=function(){s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHinnerHeight||document.body.clientHinnerHeight,document.onmouseup=n,document.onmousemove=o})}mainUsrController(){const t=this;document.onclick=function(e){if(t.isBestResultsWindowActive&&(t.isBestResultsWindowActive=!1,t.bestResultsWindow.classList.remove("displ-blck")),"resetBtn"===e.target.id)return t.resetShuffledMatrix(),t.setAllPartsInItsPos(),t.shuffle(),clearInterval(t.timerID),t.resetTimer(),void t.clearSteps();if("soundBtn"===e.target.id)return t.soundBtn.innerText=t.isSound?t.string[t.lang].soundBtnOFF:t.string[t.lang].soundBtn,void(t.isSound=!t.isSound);if("stepBtn"===e.target.id)return t.isAutoMode=!t.isAutoMode,void(t.isAutoMode&&t.makeAISteps());if("saveBtn"===e.target.id)return void t.setCurrentGameLS();if("loadBtn"===e.target.id)return void t.getSavedGamesLS();if("closeLoadWindowInteractionBTN"===e.target.id&&t.isSavedGamesWindowActive&&(t.isSavedGamesWindowActive=!1,t.loadWindowInteraction.classList.remove("displ-blck")),e.target.dataset.setGame&&t.loadGame(JSON.parse(e.target.dataset.setGame)),"bestResBtn"===e.target.id)return void t.getBestResLS();if("stopStartBtn"===e.target.id)return t.stopStartBtn.innerText=t.isPaused?t.string[t.lang].stopBtn:t.string[t.lang].startBtn,void t.pauseGame();if(!e.target.dataset.elNum)return;const s=e.target.dataset.elNum,i=t.getCurrentElNum(s);if(!t.isPaused){if(t.isDrggblToTop(s)){t.changeStepCountNum();const o=t.getTopCurrentElNum(s);return t.changDrgblClass(e.target.id,"cube-position",i,o),t.changeObPosVal(s),void(t.isSound&&t.soundObj.play())}if(t.isDrggblToBottom(s)){t.changeStepCountNum();const o=t.getBottomCurrentElNum(s);return t.changDrgblClass(e.target.id,"cube-position",i,o),t.changeObPosVal(s),void(t.isSound&&t.soundObj.play())}if(t.isDrggblToRight(s)){t.changeStepCountNum();const o=t.getRightCurrentElNum(s);return t.changDrgblClass(e.target.id,"cube-position",i,o),t.changeObPosVal(s),void(t.isSound&&t.soundObj.play())}if(t.isDrggblToLeft(s)){t.changeStepCountNum();const o=t.getLeftCurrentElNum(s);t.changDrgblClass(e.target.id,"cube-position",i,o),t.changeObPosVal(s),t.isSound&&t.soundObj.play()}}},document.onchange=function(e){"dimSelect"===e.target.id&&(clearInterval(t.timerID),t.resetTimer(),t.clearSteps(),t.setDimentionXY(e.target.options[e.target.selectedIndex].dataset.dim),t.setMainElNum(),t.setOffset(),t.mainContainer.innerHTML="",t.araseMatrix(),t.resetShuffledMatrix(),t.setAllPartsInItsPos(),t.showMatrix(),t.shuffle()),"imgSelect"===e.target.id&&(t.currentImage=e.target.options[e.target.selectedIndex].dataset.dim,t.setCSSProperty(".main-container div","backgroundImage",`url("../images/${t.currentImage}.jpg")`),t.imagesDescribe.innerText="")},window.onresize=function(){(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<480?(t.isMobile=!0,t.setOffset()):t.isMobile&&(t.isMobile=!1,t.setOffset())}}};document.addEventListener("DOMContentLoaded",(()=>{e.render()}))})();